1.Подключение к серверу:
    Откройте MobaXterm.
    Нажмите Session в левом верхнем углу.
    В поле Remote host введите IP-адрес вашего сервера.
    Убедитесь, что порт установлен в 22 (порт SSH по умолчанию).
    Введите имя пользователя (обычно root).
    Нажмите OK и введите пароль при запросе (вставьте с помощью Ctrl+V или правой кнопки мыши).
2.Первоначальная настройка сервера:
    После первого входа перезагрузите сервер командой: reboot
    Подождите минуту и подключитесь заново.
    Система может предложить обновиться. Если да, выполните: do-release-upgrade
    Подтверждайте все запросы, вводя y или нажимая Enter. Этот процесс может занять около 30 минут.
3.Защита SSH-доступа:
    Смените стандартный порт SSH для повышения безопасности. Выполните: sudo nano /etc/ssh/sshd_config
    Найдите строку # Port 22. Удалите # и измените 22 на нестандартный порт (например, Port 2222). Важно: Не используйте очевидные порты.
    Сохраните файл (Ctrl+O) и выйдите из редактора (Ctrl+X).
    Перезапустите SSH-сервис: sudo systemctl restart sshd
    Внимание: Закройте текущую сессию и откройте новую в MobaXterm, указав в настройках подключения ваш новый порт SSH (например, 2222). Не закрывайте старую сессию, пока не убедитесь, что новая работает.
4.Настройка фаервола (UFW):
    Активируйте фаервол и откройте новый порт для SSH: sudo ufw enable && sudo ufw allow 2222/tcp (Замените 2222 на ваш порт).
    Убедитесь, что подключение с новым портом работает, прежде чем закрывать исходную сессию.
5.Запрет ответа на ping:
    Чтобы улучшить скрытность, настройте фаервол на игнорирование ping-запросов: sudo nano /etc/ufw/before.rules
    Найдите секции # ok icmp codes for INPUT и # ok icmp code for FORWARD.
    Внутри этих блоков измените все правила ACCEPT для ICMP на DROP.
    Сохраните файл и выйдите.
    Перезагрузите фаервол: sudo ufw disable && sudo ufw enable
    Проверка: Откройте Командную строку (cmd) в Windows и выполните ping ваш-ip-адрес. В ответ должны быть ошибки "Превышен интервал ожидания".
6.Установка панели 3x-ui:
    Актуальную команду для установки всегда можно найти на официальной странице GitHub: https://github.com/MHSanaei/3x-ui
    На дату 02.11.2025 команда выглядит так:
    bash
7.bash <(curl -Ls https://raw.githubusercontent.com/mhsanaei/3x-ui/master/install.sh)
    Если в начале строки у вас указано (venv), сначала выполните deactivate.
    Запустите скрипт установки. Он запросит порт для панели — выберите любой (например, 2053).
    После завершения установки в терминале будет выделен зелёный блок с данными для входа (URL, логин, пароль). Обязательно сохраните эту информацию в надёжном месте.
Вход в панель 3x-ui:
    Откройте порт панели в фаерволе: sudo ufw allow 2053/tcp
    В браузере перейдите по адресу http://ваш-ip-адрес:2053. Войдите, используя полученные логин и пароль.
8.Создание Reality-подключения (Inbound):
    В панели 3x-ui перейдите в Inbounds и нажмите Add Inbound.
    Remark: Введите любое название (например, "Мое-Reality").
    Protocol: Выберите vless.
    Client Flow: Выберите xtls-rprx-vision.
    Port: Установите свой порт (например, 1234). Не забудьте потом открыть его в фаерволе (ufw allow 1234/tcp).
    Reality Settings: В поле Dest можно заменить сайт по умолчанию (например, yahoo.com) на другой, например google.com. Нажмите Get New Cert.
    Нажмите Create.
    Перезагрузка фаервола: Выполните sudo ufw disable && sudo ufw enable, чтобы новое правило для порта вступило в силу.
9.Настройка клиента (NekoRay / NekoBox):
    ПК: Скачайте NekoRay, распакуйте архив и запустите исполняемый файл от имени Администратора. Выберите ядро sing-box.
    Телефон: Скачайте NekoBox из магазина приложений.
    В панели 3x-ui найдите созданное подключение и скопируйте ссылку-конфигурацию.
    В NekoRay перейдите в Программа -> Добавить профиль из буфера обмена.
    Нажмите правой кнопкой мыши на новый профиль и выберите Запустить.
    В правом верхнем углу установите режим TUN Mode.
